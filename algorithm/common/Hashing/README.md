# Hashing

## 개념

- 고기와 감자를 잘게 다져 섞어 요리하여 따뜻하게 차려 낸 것

- 데이터를 담을 테이블을 미리 크게 확보해 놓은 후 입력받은 데이터를 해시하여 테이블 내의 주소를 계산하고 이 주소에 데이터를 담는 것, 이것이 해시 테이블의 기본 개념이다.

## 용도

- 해시 테이블:  해시테이블은 데이터의 해시 값을 테이블 내의 주소로 이용하는 궁극의 탐색 알고리즘이다. 빠르다고 정평이 나있는 이진 탐색보다도 빠르다.

- 암호화:  해시는 입력받은 데이터를 완전히 새로운 모습의 데이터로 만든다. 해시를 통해 변환된 데이터는 원본의 모습을 알아볼 수 없을 정도로 완전히 달라진다. 이 특성 때문에 해시는 암호화 영역에서 아주 주요하게 사용되고 있다. SHA(Secure Hash Algorithm)알고리즘이 그 대표적인 예이다.

- 데이터 축약:  해시는 길이가 서로 다른 입력 데이터에 대해 일정한 길이의 출력을 만들 수 있다. 이 특성을 이용하면 커다란 데이터를 '해시'하면 짧은 길이로 축약할 수 있다. 이렇게 축약된 데이터끼리 비교를 수행하면 커다란 원본 데이터들을 비교하는 것에 비해 엄청난 효율을 거둘 수 있다.

## 해시 함수

### 나눗셈법(Division Method)

```
주소 = 입력값 % 테이블 크기
```

- 단점:  서로 다른 입력 값에 대해 동일한 해시 값, 즉 해시 테이블 내의 동일한 주소를 반환할 가능성이 높다. 이것을 충돌(Collision)이라고 하는데, 설사 똑같은 해시 값이 아니더라도 해시 테이블 내의 일부 지역의 주소들을 집중적으로 반환하는 결과로 데이터들이 한 곳에 모이는 문제(이를 클러스터(Cluster)라고 함)가 발생할 가능성이 높다.

### 자릿수 접기(Digits Folding)

충돌 및 클러스터 가능성을 줄인 알고리즘. 종이를 접듯이 숫자를 일정한 크기 이하의 수로 만드는 방법이다.

```
8129335 = 8 + 1 + 2 + 9 + 3 + 3 + 5 = 31
81 + 29 + 33 + 5 = 148
```

자릿수 접기는 문자열을 키로 사용하는 해시 테이블에 특히 잘 어울리는 알고리즘이다. 문자열의 각 요소를 ASCII코드 번호(0~127)로 바꾸고 이 값들을 각각 더하여 접으면 문자열을 해시 테이블 내의 주소로 바꿀 수 있다.

`쉬프트 연산`을 통해 자릿수 접기 알고리즘이 해시테이블의 주소값들을 모두 활용하지 않는 문제점을 해결할 수 있다.
 
## 충돌 해결하기

폐쇄 해싱(Closed Hashing), 개방 해싱(Open Hashing) 

### 체이닝(Chaining)
해시 함수로 서로 다른 키에 대해 같은 주소값을 반환해서 충돌이 발생하면 각 데이터를 해당 주소에 있는 링크드 리스트에 삽입하여 문제를 해결하는 기법

단점:  체이닝은 원하는 데이터를 찾기 위해 순차 탐색을 해야 하는 링크드 리스트의 단점을 고스란히 갖고 있다. 해시 테이블은 '극한의 탐색'을 위해 고안되었는데 순차 탐색으로 그 성능을 제대로 발휘하지 못한다.

### 개방 주소법(Open Addressing)
충돌이 일어날 때 해시 함수에 의해 얻어진 주소가 아니더라도 얼마든지 다른 주소를 사용할 수 있도록 허용하는 충돌 해결 알고리즘이다.

- 선형 탐색(Linear Probing):  선형 탐색(Linear Probing)은 가장 간단한 탐사 방법이다. 해시 함수로부터 얻어낸 주소에 이미 다른 데이터가 입력되어 있음을 발견하면, 현재 주소에서 고정 폭으로 다음 주소로 이동한다. 그 주소에 다른 데이터가 있어 충돌이 발생하면 또 그 다음 주소로 이동한다. 이렇게 해서 비어 있는 주소를 찾아내면 데이터를 입력한다.

- 제곱 탐색(Quadratic Probing):  선형 탐사와 비교해서 크게 다르지 않다. 선형 탐사가 다음 주소를 위해 고정폭만큼 이동하는 것에 비해 제곱 탐사는 이동폭이 제곱수로 늘어난다는 것이 다를 뿐이다.

- 이중 해싱(Double Hashing): 클러스터를 제대로 방지할 수 있는 방법은 탐사할 주소의 규칙성을 없애버리는 길 뿐이다. 해시 함수에 키를 입력하여 얻어낸 주소에서 충돌이 일어나면 새로운 주소를 향해 이동해야 한다. 2개의 해시 함수를 준비해서 하나는 최초의 주소를 얻을 때 또 다른 하나는 충돌이 일어났을 때 탐사 이동폭을 얻기 위해 사용한다.

- 재해싱(Rehashing):  남은 공간이 없는 해시 테이블에서는 충돌이 많이 발생하게 된다. 재해싱(Rehashing)은 이 문제를 해결할 수 있는 방법 중의 하나 이다. 재해싱은 해시 테이블의 크기를 늘리고, 늘어난 해시 테이블의 크기에 맞추어 테이블 내의 모든 데이터를 다시 해싱한다. 테이블의 공간 사용률이 70 ~ 80%에 이르면 성능 저하가 나타난다고 한다. 그러니 재해싱을 이 전에 수행해야 성능 저하가 나타나는 것을 막을 수 있을 것이다. 

## 출처

https://dbehdrhs.tistory.com/70

